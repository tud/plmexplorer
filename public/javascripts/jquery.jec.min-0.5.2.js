(function($){$.fn.editableCombobox=function(options){var defaults={position:0,classes:'',styles:{},pluginClass:'jecEditableOption',useExistingOptions:false,ignoredKeys:[],acceptedRanges:[{min:32,max:126},{min:191,max:382}]};var options=$.extend(defaults,options);if($.browser.msie){Array.prototype.indexOf=function(object){for(var i=0;i<this.length;i++){if(this[i]==object){return i;}}return-1;}}return $(this).filter('select').each(function(){if($(this).children(options.pluginClass).length==0){var editableOption=$(document.createElement('option'));editableOption.addClass(options.pluginClass).hide();if(typeof(options.classes)=='string'){editableOption.addClass(options.classes);}else if(typeof(options.classes)=='object'){for(var i=0;i<options.classes.length;i++){editableOption.addClass(options.classes[i]);}}if(typeof(options.styles)=='object'){for(var i=0;i<options.styles.length;i++){editableOption.append(options.styles[i]);}}if($(this).children().eq(options.position).length!=0){$(this).children().eq(options.position).before(editableOption);}else{$(this).append(editableOption);}}$(this).keydown(function(event){var keyCode=getKeyCode(event);switch(keyCode){case 8:case 46:var option=$(this).children('option.'+options.pluginClass);if(option.val().length>1){$(this).children(':selected').removeAttr('selected');var value=option.val().substring(0,option.val().length-1);option.val(value).text(value).attr('selected','selected').show();}else if(option.val().length==1){option.val('').text('').hide();}return(keyCode!=8);break;}});$(this).keypress(function(event){var keyCode=getKeyCode(event);switch(keyCode){case 9:case 39:case 40:break;default:if(options.ignoredKeys.indexOf(keyCode)==-1){$(this).children(':selected').removeAttr('selected');keyValue='';for(validKey in options.acceptedRanges){if((typeof(options.acceptedRanges[validKey].exact)!='undefined'&&options.acceptedRanges[validKey].exact==keyCode)||(typeof(options.acceptedRanges[validKey].min)!='undefined'&&typeof(options.acceptedRanges[validKey].max)!='undefined'&&keyCode>=options.acceptedRanges[validKey].min&&keyCode<=options.acceptedRanges[validKey].max)){keyValue=String.fromCharCode(keyCode);}}var option=$(this).children('option.'+options.pluginClass);var value=option.val()+keyValue;option.val(value).text(value).attr('selected','selected').show();}break;}});if(options.useExistingOptions){setEditableOption($(this));$(this).change(function(){setEditableOption($(this));});}function setEditableOption(elem){elem.children('option.'+options.pluginClass).val(elem.children('option:selected').text());}function getKeyCode(event){if($.browser.msie){return event.keyCode;}else{return event.which;}}});};})(jQuery);